<div class="overflow-x-auto shadow-lg rounded-lg border border-gray-100">
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Timestamp</th>
                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Token</th>
                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">IP Address</th>
                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Request</th>
                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Response</th>
                <th class="py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Message</th>
            </tr>
            <tr class="bg-gray-100">
                <th class="py-2 px-6"><input type="text" name="name_filter" id="name_filter_input" placeholder="Filter Name" value="{{ filters.name_filter if filters.name_filter else '' }}" class="w-full p-1 text-xs border rounded-md"></th>
                <th class="py-2 px-6"><input type="text" name="timestamp_filter" id="timestamp_filter_input" placeholder="Filter Timestamp" value="{{ filters.timestamp_filter if filters.timestamp_filter else '' }}" class="w-full p-1 text-xs border rounded-md"></th> <!-- Timestamp filter -->
                <th class="py-2 px-6"><input type="text" name="token_filter" id="token_filter_input" placeholder="Filter Token" value="{{ filters.token_filter if filters.token_filter else '' }}" class="w-full p-1 text-xs border rounded-md"></th>
                <th class="py-2 px-6"><input type="text" name="ip_address_filter" id="ip_address_filter_input" placeholder="Filter IP" value="{{ filters.ip_address_filter if filters.ip_address_filter else '' }}" class="w-full p-1 text-xs border rounded-md"></th>
                <th class="py-2 px-6"><input type="text" name="request_filter" id="request_filter_input" placeholder="Filter Request" value="{{ filters.request_filter if filters.request_filter else '' }}" class="w-full p-1 text-xs border rounded-md"></th>
                <th class="py-2 px-6"><input type="text" name="status_filter" id="status_filter_input" placeholder="Filter Status" value="{{ filters.status_filter if filters.status_filter else '' }}" class="w-full p-1 text-xs border rounded-md"></th>
                <th class="py-2 px-6"></th> <!-- Response filter (not directly searchable) -->
                <th class="py-2 px-6"><input type="text" name="message_filter" id="message_filter_input" placeholder="Filter Message" value="{{ filters.message_filter if filters.message_filter else '' }}" class="w-full p-1 text-xs border rounded-md"></th>
            </tr>
        </thead>
            </tr>
            
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
            {% for log in logs.items %}
            <tr>
                <td class="py-4 px-6 whitespace-nowrap text-sm text-gray-500">{{ log.name }}</td>
                <td class="py-4 px-6 whitespace-nowrap text-sm text-gray-500">{{ log.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</td>
                <td class="py-4 px-6 whitespace-nowrap text-sm text-gray-900">
                    {% if log.token %}
                        <span class="masked-token cursor-pointer text-blue-600 hover:underline"
                              data-full-token="{{ log.token }}" onclick="toggleTokenVisibility(this)">
                            ********-****-****-****-************
                        </span>
                    {% else %}
                        N/A
                    {% endif %}
                </td>
                <td class="py-4 px-6 whitespace-nowrap text-sm text-gray-500">{{ log.ip_address }}</td>
                <td class="py-4 px-6 text-sm text-gray-700">{{ log.request }}</td>
                <td class="py-4 px-6 whitespace-nowrap text-sm">
                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full
                                 {% if log.status == 'success' %}bg-green-100 text-green-800
                                 {% else %}bg-red-100 text-red-800{% endif %}">
                        {{ log.status }}
                    </span>
                </td>
                <td class="py-4 px-6 text-sm text-gray-700">
                    {% if log.response %}
                        <button type="button" onclick="window.openGenericModal('{{ url_for('admin.get_api_log_response', log_id=log.id) }}')"
                                class="font-semibold py-1 px-2 rounded-md shadow-sm transition duration-300 ease-in-out transform hover:-translate-y-0.5 button-view-response">
                            View Response
                        </button>
                    {% else %}
                        N/A
                    {% endif %}
                </td>
                <td class="py-4 px-6 text-sm text-gray-700">{{ log.message }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
    </table>
</div>

<div class="mt-6 flex justify-between items-center">
    <div>
        <p class="text-sm text-gray-700">
            Showing <span class="font-medium">{{ (logs.page - 1) * logs.per_page + 1 }}</span> to <span class="font-medium">{{ (logs.page - 1) * logs.per_page + logs.items|length }}</span> of <span class="font-medium">{{ logs.total }}</span> results
        </p>
    </div>
    <div class="flex items-center">
        <label for="per_page_api" class="text-sm text-gray-700 mr-2">Items per page:</label>
        <select id="per_page_api" name="per_page"
                class="block w-20 p-1 text-xs border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
            {% for num in [10, 25, 50, 100] %}
            <option value="{{ num }}" {% if logs.per_page == num %}selected{% endif %}>{{ num }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="flex-1 flex justify-end">
        {% if logs.has_prev %}
        <a href="{{ url_for('admin.logs_content', page=logs.prev_num, per_page=logs.per_page, log_type='api', **filters) }}" data-path="{{ url_for('admin.logs_content', page=logs.prev_num, per_page=logs.per_page, log_type='api', **filters) }}" class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
            Previous
        </a>
        {% endif %}
        {% if logs.has_next %}
        <a href="{{ url_for('admin.logs_content', page=logs.next_num, per_page=logs.per_page, log_type='api', **filters) }}" data-path="{{ url_for('admin.logs_content', page=logs.next_num, per_page=logs.per_page, log_type='api', **filters) }}" class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
            Next
        </a>
        {% endif %}
    </div>
</div>